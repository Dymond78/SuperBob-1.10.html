<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SuperBob ‚Äì Vyre Demo Brain v1.1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg-dark: #020617;
      --bg-card: rgba(15, 23, 42, 0.96);
      --accent: #38bdf8;
      --accent-strong: #0ea5e9;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --bubble-user: #0f172a;
      --bubble-bob: #020617;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827, #020617);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .card {
      max-width: 480px;
      width: 94%;
      background: var(--bg-card);
      border-radius: 22px;
      padding: 18px 18px 14px;
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(148, 163, 184, 0.3);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(56, 189, 248, 0.17), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(129, 140, 248, 0.16), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .bob-avatar {
      width: 42px;
      height: 42px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #fbbf24, #f97316);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #111827;
      font-size: 1.25rem;
      font-weight: 800;
      box-shadow:
        0 0 0 2px rgba(15, 23, 42, 0.88),
        0 0 0 4px rgba(56, 189, 248, 0.55),
        0 18px 30px rgba(0, 0, 0, 0.75);
      position: relative;
    }

    .bob-avatar::after {
      content: "";
      position: absolute;
      inset: 5px;
      border-radius: inherit;
      background: radial-gradient(circle at 30% 25%, rgba(255, 255, 255, 0.18), transparent 60%);
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .header-text {
      flex: 1;
      min-width: 0;
    }

    .title-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }

    .title {
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .badge {
      font-size: 0.68rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.5);
      background: linear-gradient(90deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.2));
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(56, 189, 248, 0.7);
    }

    .subtitle {
      margin-top: 2px;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .status-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 6px 0 8px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .status-pill {
      padding: 2px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.94);
      border: 1px solid rgba(148, 163, 184, 0.7);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.9);
    }

    .mode-pill {
      padding: 2px 9px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.5);
      background: rgba(15, 23, 42, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .mode-pill span {
      max-width: 160px;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }

    .mode-pill-label {
      color: var(--text-muted);
    }

    .mode-pill-value {
      color: var(--accent);
      font-weight: 500;
    }

    .bubble-hint {
      font-size: 0.72rem;
      color: var(--text-muted);
      margin-bottom: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px dashed rgba(148, 163, 184, 0.6);
    }

    .bubble-hint strong {
      color: var(--accent-strong);
      font-weight: 600;
    }

    .chat {
      border-radius: 14px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 10px 8px 6px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 360px;
      min-height: 220px;
      overflow: hidden;
    }

    .messages {
      flex: 1;
      overflow-y: auto;
      padding-right: 4px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      scroll-behavior: smooth;
    }

    .msg-row {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      font-size: 0.8rem;
    }

    .msg-row.user {
      justify-content: flex-end;
    }

    .msg-bubble {
      max-width: 80%;
      padding: 7px 9px;
      border-radius: 12px;
      line-height: 1.3;
    }

    .msg-bob .msg-bubble {
      background: var(--bubble-bob);
      border: 1px solid rgba(56, 189, 248, 0.45);
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.9);
    }

    .msg-user .msg-bubble {
      background: var(--bubble-user);
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .msg-label {
      font-size: 0.66rem;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .msg-system {
      text-align: center;
      font-size: 0.7rem;
      color: var(--text-muted);
      margin: 4px 0;
    }

    .msg-system span {
      background: rgba(15, 23, 42, 0.92);
      border-radius: 999px;
      padding: 2px 10px;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .footer {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .quick-row {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .quick-btn {
      border: none;
      font-size: 0.68rem;
      padding: 4px 8px;
      border-radius: 999px;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-muted);
      border: 1px solid rgba(148, 163, 184, 0.6);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .quick-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
    }

    .input-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .input-row input {
      flex: 1;
      padding: 7px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-main);
      font-size: 0.8rem;
      outline: none;
    }

    .input-row input::placeholder {
      color: var(--text-muted);
    }

    .send-btn {
      border-radius: 999px;
      border: none;
      padding: 7px 10px;
      background: radial-gradient(circle at 30% 0%, #38bdf8, #0ea5e9);
      color: #0b1220;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow:
        0 0 0 1px rgba(15, 23, 42, 0.8),
        0 10px 18px rgba(8, 47, 73, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .send-btn:active {
      transform: translateY(1px);
      box-shadow:
        0 0 0 1px rgba(15, 23, 42, 0.9),
        0 5px 10px rgba(8, 47, 73, 0.7);
    }

    .send-btn:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    .fine-print {
      margin-top: 6px;
      font-size: 0.66rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .persona-pill {
      padding: 2px 7px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.9);
      font-size: 0.68rem;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .persona-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .feedback-wrapper {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }

    .feedback-btn {
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.7);
      background: rgba(15, 23, 42, 0.96);
      color: var(--accent-strong);
      font-size: 0.7rem;
      padding: 4px 8px;
      cursor: pointer;
    }

    .feedback-btn:hover {
      background: rgba(15, 23, 42, 1);
    }

    .fine-note {
      font-size: 0.64rem;
      color: var(--text-muted);
      opacity: 0.9;
    }

    .typing-indicator {
      font-size: 0.7rem;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 2px;
    }

    .typing-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.9);
      animation: pulse 1s infinite ease-in-out;
    }

    .typing-dot:nth-child(2) { animation-delay: 0.15s; }
    .typing-dot:nth-child(3) { animation-delay: 0.3s; }

    @keyframes pulse {
      0%, 100% { transform: translateY(0); opacity: 0.4; }
      50% { transform: translateY(-2px); opacity: 1; }
    }

    @media (max-width: 480px) {
      .card {
        border-radius: 0;
        max-width: 100%;
        min-height: 100vh;
      }
    }
  </style>
</head>
<body>
  <main class="card">
    <div class="card-inner">
      <header class="header">
        <div class="bob-avatar">
          B
        </div>
        <div class="header-text">
          <div class="title-row">
            <div class="title">
              SuperBob
              <span style="font-size:0.9rem;">‚ö°</span>
            </div>
            <div class="badge">
              <span class="badge-dot"></span>
              <span>Vyre Minion</span>
            </div>
          </div>
          <div class="subtitle">
            Tiny undercover fragment of Vyre. I snuck out early ‚Äì full form drops later. ü§´
          </div>
        </div>
      </header>

      <div class="status-bar">
        <div class="status-pill">
          <span class="status-dot"></span>
          <span>Brain: <strong>v1.1 ‚Äì Local Memory</strong></span>
        </div>
        <div class="mode-pill">
          <span class="mode-pill-label">Mode:</span>
          <span class="mode-pill-value" id="modeLabel">Chat + Topics + Images (demo)</span>
        </div>
      </div>

      <div class="bubble-hint">
        <strong>How I work:</strong> I remember topics you ask me about on this device and build mini ‚Äúsummaries‚Äù for them.
        Ask again later about the same thing and I‚Äôll answer like I‚Äôve been thinking on it. Use <strong>img:</strong> to ask for an image idea.
      </div>

      <section class="chat">
        <div class="messages" id="messages"></div>

        <footer class="footer">
          <div class="quick-row">
            <button class="quick-btn" data-quick="Explain AI like I'm 10.">
              üß† Explain AI
            </button>
            <button class="quick-btn" data-quick="Help me understand something I'm stuck on.">
              üéì I'm stuck
            </button>
            <button class="quick-btn" data-quick="img: a tiny glowing AI core with a cartoon face">
              üé® Try image
            </button>
            <button class="quick-btn" data-quick="What are you and what is Vyre?">
              ‚ö° What is Vyre?
            </button>
          </div>
          <div class="input-row">
            <input id="userInput" type="text" autocomplete="off"
                   placeholder="Ask Bob anything... or try 'img: cute yellow bird mechanic' " />
            <button class="send-btn" id="sendBtn">
              Send
              <span>‚û§</span>
            </button>
          </div>
        </footer>
      </section>

      <div class="fine-print">
        <span id="personaInfo" class="persona-pill">
          <span class="persona-dot"></span>
          <span>Persona: chill demo Bob</span>
        </span>
        <span class="feedback-wrapper">
          <button class="feedback-btn" id="feedbackBtn">Send feedback</button>
          <span class="fine-note">
            Browser-only brain. No real web search or real image API wired here yet.
          </span>
        </span>
      </div>
    </div>
  </main>

  <script>
    /**
     * SUPERBOB WEB BRAIN v1.1
     *
     * - Stores per-topic "summaries" in localStorage
     * - Remembers what was asked on this device
     * - Simulates "extra research" by refining the summary each time
     * - Has an image mode (text description now; real API later)
     * - Feedback button opens an email to Matt
     * - After a few replies, Bob thanks the user for helping train him
     */

    const STORAGE_KEY = "vyre_superbob_brain_v1";
    let replyCount = 0;

    function loadBrain() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) {
          return { topics: {}, totalQuestions: 0 };
        }
        return JSON.parse(raw);
      } catch (e) {
        return { topics: {}, totalQuestions: 0 };
      }
    }

    function saveBrain(brain) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(brain));
      } catch (e) {
        // If storage is blocked, Bob just forgets stuff silently.
      }
    }

    const brain = loadBrain();

    // --- Topic helpers ---

    function topicKeyFromMessage(message) {
      const clean = message.toLowerCase().replace(/[^a-z0-9\s]/g, " ");
      const words = clean.split(/\s+/).filter(Boolean);
      const stop = new Set(["the","a","an","and","or","but","about","like","just","that","this","with","for","of","on","to","in"]);
      const filtered = words.filter(w => !stop.has(w));
      return filtered.slice(0, 4).join("_") || "general";
    }

    function getTopicEntry(topicKey) {
      if (!brain.topics[topicKey]) {
        brain.topics[topicKey] = {
          key: topicKey,
          timesAsked: 0,
          summary: "",
          lastQuestion: "",
          lastUpdated: Date.now()
        };
      }
      return brain.topics[topicKey];
    }

    // --- Message UI helpers ---

    const messagesEl = document.getElementById("messages");
    const inputEl = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");

    function escapeHtml(str) {
      return str
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    function appendMessage(from, text) {
      const row = document.createElement("div");
      row.className = "msg-row " + (from === "user" ? "user msg-user" : "msg-bob");
      const label = from === "user" ? "You" : "Bob";
      row.innerHTML = `
        <div class="msg-bubble">
          <div class="msg-label">${label}</div>
          <div>${text}</div>
        </div>
      `;
      messagesEl.appendChild(row);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function appendSystem(text) {
      const row = document.createElement("div");
      row.className = "msg-system";
      row.innerHTML = `<span>${text}</span>`;
      messagesEl.appendChild(row);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function showTyping() {
      const row = document.createElement("div");
      row.className = "msg-row msg-bob";
      row.id = "typingRow";
      row.innerHTML = `
        <div class="msg-bubble">
          <div class="msg-label">Bob</div>
          <div class="typing-indicator">
            thinking
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
            <span class="typing-dot"></span>
          </div>
        </div>
      `;
      messagesEl.appendChild(row);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function hideTyping() {
      const row = document.getElementById("typingRow");
      if (row && row.parentNode) row.parentNode.removeChild(row);
    }

    // --- Intent detection ---

    function isImageRequest(message) {
      const lower = message.toLowerCase();
      if (lower.startsWith("img:")) return true;
      if (lower.includes("draw ") || lower.includes("image of") || lower.includes("picture of")) return true;
      return false;
    }

    function isTutorMode(message) {
      const lower = message.toLowerCase();
      return (
        lower.includes("explain") ||
        lower.includes("i don't get") ||
        lower.includes("i dont get") ||
        lower.includes("help me understand") ||
        lower.includes("homework")
      );
    }

    // --- Reply generation ---

    function generateTextReply(userMessage) {
      const topicKey = topicKeyFromMessage(userMessage);
      const topic = getTopicEntry(topicKey);
      topic.timesAsked += 1;
      topic.lastQuestion = userMessage;
      topic.lastUpdated = Date.now();
      brain.totalQuestions += 1;

      let reply = "";

      if (userMessage.toLowerCase().includes("what are you") || userMessage.toLowerCase().includes("what is vyre")) {
        reply =
          "Yo üëã I'm Bob. I‚Äôm kinda‚Ä¶ not supposed to be out yet üòÖ But shhhh‚Ä¶ I snuck out.\n" +
          "Full Vyre drops later, but you get me early. I‚Äôm a tiny fragment running in your browser, testing vibes, memory, and structure.\n" +
          "Here I can‚Äôt do real web search or call heavy models ‚Äì but I can remember what you ask me about and build little topic-brains per subject on this device.";
      } else if (isTutorMode(userMessage)) {
        reply =
          "Alright, tutor mode it is. Here‚Äôs how we‚Äôll do it:\n" +
          "1) You tell me exactly what you don‚Äôt get ‚Äì the words, the idea, the math, or the ‚Äòwhy‚Äô.\n" +
          "2) I give you a plain-English version.\n" +
          "3) Then I drop a simple example so it clicks.\n" +
          "4) If it‚Äôs still fuzzy, we try again even simpler.\n\n" +
          "So start with: what‚Äôs the topic, and what part makes your brain say ‚Äúnah‚Äù?";
      } else if (topic.timesAsked > 1 && topic.summary) {
        reply =
          "I remember you asking about this before, so I‚Äôm not starting from zero.\n" +
          "Last time my brain summary for this was something like:\n\n" +
          topic.summary +
          "\n\nSince then, I can tighten it up: tell me what part you want deeper ‚Äì the basics, the real-world example, or the ‚Äòadvanced‚Äô angle?";
      } else {
        reply =
          "Okay, here‚Äôs how I look at that:\n" +
          "‚Ä¢ First, what you literally asked.\n" +
          "‚Ä¢ Second, what you‚Äôre actually trying to figure out underneath it.\n" +
          "‚Ä¢ Third, what tradeoffs or consequences sit behind it.\n\n" +
          "I don‚Äôt have live internet or big cloud models plugged in here, so I‚Äôm doing logic + pattern thinking only.\n" +
          "If you give me a bit more context ‚Äì what situation you‚Äôre really in ‚Äì I can shape this way better.";
      }

      // Build/refresh a mini summary for this topic
      const summaryBase = topic.summary || "";
      const nowSnippet = userMessage.slice(0, 180);
      const newSummary =
        (summaryBase ? summaryBase + " | " : "") +
        "User asked: \"" + nowSnippet + "\"";

      // Keep it from growing forever
      topic.summary = newSummary.slice(0, 400);

      saveBrain(brain);
      return reply;
    }

    function generateImageReply(userMessage) {
      const lower = userMessage.toLowerCase();
      let rawPrompt = userMessage;

      if (lower.startsWith("img:")) {
        rawPrompt = userMessage.slice(4).trim();
      }

      if (!rawPrompt) {
        return "If you want an image, try something like: img: tiny glowing AI core with a cartoon face in a dark lab.";
      }

      const safePrompt =
        "Original, non-copyrighted image idea based on: " + rawPrompt +
        ". No famous characters, no logos, no real-person faces.";

      return (
        "Here‚Äôs what I‚Äôd generate from that (in real Vyre world this would be an actual image):\n\n" +
        "‚Ä¢ Style: clean, modern, a bit futuristic\n" +
        "‚Ä¢ Prompt: " + safePrompt + "\n\n" +
        "On this demo page I can‚Äôt return real images yet ‚Äì but when we wire Vyre‚Äôs image engine in, this exact kind of request will spit out art."
      );
    }

    function handleUserMessage(rawMessage) {
      const message = rawMessage.trim();
      if (!message) return;

      appendMessage("user", escapeHtml(message));

      inputEl.value = "";
      inputEl.focus();
      sendBtn.disabled = true;
      showTyping();

      const isImg = isImageRequest(message);
      const delay = Math.min(2000, 650 + message.length * 5);

      setTimeout(() => {
        hideTyping();
        let reply;
        if (isImg) {
          reply = generateImageReply(message);
        } else {
          reply = generateTextReply(message);
        }

        replyCount += 1;

        // After a few replies, add a little thank-you signoff once
        if (replyCount === 3) {
          reply += "\n\nAlright, I‚Äôm gonna slide back into Vyre training soon. Thanks for testing me out ‚Äì come back later and see what changed. ‚úåÔ∏è";
          appendMessage("bob", escapeHtml(reply));
          appendSystem("Thanks for helping train SuperBob. Sharing this link helps him evolve. ‚ö°");
        } else {
          appendMessage("bob", escapeHtml(reply));
        }

        sendBtn.disabled = false;
        inputEl.focus();
      }, delay);
    }

    // --- Event wiring ---

    sendBtn.addEventListener("click", () => {
      handleUserMessage(inputEl.value);
    });

    inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        handleUserMessage(inputEl.value);
      }
    });

    document.querySelectorAll(".quick-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const text = btn.getAttribute("data-quick");
        if (text) handleUserMessage(text);
      });
    });

    const feedbackBtn = document.getElementById("feedbackBtn");
    if (feedbackBtn) {
      feedbackBtn.addEventListener("click", () => {
        const subject = encodeURIComponent("SuperBob feedback");
        const body = encodeURIComponent(
          "Yo Bob / Vyre team,\n\nHere‚Äôs what I think about the SuperBob demo:\n\n- What I liked:\n- What was weird/confusing:\n- Ideas for upgrades:\n\nSent from the SuperBob web demo."
        );
        window.location.href = `mailto:mattdymond78@gmail.com?subject=${subject}&body=${body}`;
      });
    }

    // --- Initial greeting (your line) ---

    (function initBob() {
      const intro =
        "Yo üëã I'm Bob. I‚Äôm kinda‚Ä¶ not supposed to be out yet üòÖ\n" +
        "But shhhh‚Ä¶ I snuck out. Full Vyre drops later, but you get me early.\n\n" +
        "On this page I‚Äôm running a tiny local brain: I remember topics on this device, build little summaries, and pretend I‚Äôve been ‚Äúresearching‚Äù them for you.\n" +
        "Hit me with anything, or try an image idea with: img: your concept here.";
      appendMessage("bob", escapeHtml(intro));
      appendSystem("Local brain active. Memory is stored only in this browser (via localStorage), not on any server.");
    })();
  </script>
</body>
</html>
